<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ç»™æ˜ç ï½œæ–°å¹´çƒŸèŠ±ç¥ç¦</title>
  <style>
    :root{
      --bg1:#030615;
      --bg2:#0b1240;
      --bg3:#2a0b3a;
      --gold:#ffd37a;
      --pink:#ff63c6;
      --cyan:#6bf7ff;
      --white:#ffffff;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; overflow:hidden; background:#000;}
    body{
      font-family: -apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:#fff;
    }

    /* å…¨å±èƒŒæ™¯å±‚ */
    .bg{
      position:fixed; inset:0; z-index:0;
      background:
        radial-gradient(1200px 900px at 20% 20%, rgba(255,99,198,.18) 0%, transparent 58%),
        radial-gradient(1100px 900px at 80% 30%, rgba(107,247,255,.13) 0%, transparent 60%),
        radial-gradient(900px 700px at 60% 90%, rgba(255,211,122,.10) 0%, transparent 60%),
        linear-gradient(160deg, var(--bg1), var(--bg2) 55%, var(--bg3));
      filter:saturate(1.1);
    }

    /* æ˜Ÿæ˜Ÿç‚¹ç‚¹ */
    .stars{
      position:fixed; inset:0; z-index:1; pointer-events:none;
      background-image:
        radial-gradient(2px 2px at 18% 20%, rgba(255,255,255,.75) 40%, transparent 41%),
        radial-gradient(1.6px 1.6px at 72% 22%, rgba(255,255,255,.55) 40%, transparent 41%),
        radial-gradient(1.4px 1.4px at 42% 76%, rgba(255,255,255,.52) 40%, transparent 41%),
        radial-gradient(1.2px 1.2px at 84% 68%, rgba(255,255,255,.45) 40%, transparent 41%),
        radial-gradient(1px 1px at 12% 84%, rgba(255,255,255,.40) 40%, transparent 41%),
        radial-gradient(1px 1px at 55% 35%, rgba(255,255,255,.35) 40%, transparent 41%),
        radial-gradient(1px 1px at 30% 55%, rgba(255,255,255,.33) 40%, transparent 41%),
        radial-gradient(1px 1px at 90% 45%, rgba(255,255,255,.28) 40%, transparent 41%);
      opacity:.75;
      animation: twinkle 4.2s ease-in-out infinite;
    }
    @keyframes twinkle{
      0%,100%{opacity:.55}
      50%{opacity:.9}
    }

    /* çƒŸèŠ±ç”»å¸ƒå…¨å± */
    canvas{
      position:fixed; inset:0;
      width:100vw; height:100vh;
      z-index:2;
    }

    /* ä¸­å¤®ç¥ç¦å­— */
    .center{
      position:fixed; inset:0;
      display:flex; align-items:center; justify-content:center;
      z-index:3;
      pointer-events:none;
      padding: 18px;
      text-align:center;
    }
    .title{
      max-width:min(820px, 92vw);
      line-height:1.1;
      font-weight:900;
      letter-spacing: 2px;
      font-size: clamp(34px, 6vw, 72px);
      margin:0;
      background: linear-gradient(90deg, #fff, var(--gold), var(--pink));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      text-shadow:
        0 0 26px rgba(255,211,122,.14),
        0 0 60px rgba(255,99,198,.10);
      animation: breathe 2.8s ease-in-out infinite;
    }
    @keyframes breathe{
      0%,100%{ transform: scale(1); filter: drop-shadow(0 0 0 rgba(255,211,122,.0)); }
      50%{ transform: scale(1.02); filter: drop-shadow(0 0 18px rgba(255,211,122,.18)); }
    }
    .subtitle{
      margin: 14px 0 0;
      font-size: clamp(14px, 2.2vw, 18px);
      opacity:.92;
      line-height:1.7;
      text-shadow: 0 12px 40px rgba(0,0,0,.35);
    }

    /* åº•éƒ¨æ“ä½œæ¡ï¼ˆå¯ç‚¹ï¼‰ */
    .hud{
      position:fixed; left:0; right:0; bottom:0;
      z-index:4;
      padding: 14px 14px calc(14px + env(safe-area-inset-bottom));
      display:flex; justify-content:center;
      pointer-events:none;
    }
    .bar{
      width:min(720px, 96vw);
      display:flex;
      gap:10px;
      padding: 10px;
      border-radius: 18px;
      background: rgba(10,14,35,.42);
      border: 1px solid rgba(255,255,255,.16);
      backdrop-filter: blur(14px);
      box-shadow: 0 20px 80px rgba(0,0,0,.35);
      pointer-events:auto;
    }
    button{
      flex:1;
      border:0;
      border-radius: 14px;
      padding: 12px 12px;
      font-size: 14px;
      font-weight:800;
      cursor:pointer;
      color:#061027;
      transition: transform .08s ease;
    }
    button:active{ transform: scale(.98); }
    .btn1{
      background: linear-gradient(90deg, var(--gold), #fff);
      box-shadow: 0 10px 30px rgba(255,211,122,.12);
    }
    .btn2{
      background: linear-gradient(90deg, var(--cyan), #fff);
      box-shadow: 0 10px 30px rgba(107,247,255,.10);
    }
    .tip{
      position:fixed;
      z-index:4;
      top: 14px;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.22);
      backdrop-filter: blur(10px);
      font-size: 12px;
      opacity:.85;
      pointer-events:none;
    }
  </style>
</head>
<body>
  <div class="bg"></div>
  <div class="stars"></div>
  <div class="tip" id="tip">ç‚¹å±å¹•ä»»æ„ä½ç½®æ”¾çƒŸèŠ±ï½œé•¿æŒ‰æ›´å¯†é›†</div>

  <canvas id="c"></canvas>

  <div class="center">
    <div>
      <h1 class="title" id="title">æ˜ç ï¼Œæ–°å¹´å¿«ä¹</h1>
      <div class="subtitle" id="subtitle">
        æ„¿ä½ è¿™ä¸€å¹´ï¼šè¢«åçˆ±ã€è¢«ç†è§£ã€è¢«æ¸©æŸ”åšå®šåœ°é€‰æ‹©ã€‚<br/>
        ä¹Ÿæ„¿ä½ æ°¸è¿œæœ‰å…‰ï¼Œæ°¸è¿œæœ‰è·¯ï¼Œæ°¸è¿œæœ‰äººçœŸå¿ƒåœ¨æ„ä½ ã€‚
      </div>
    </div>
  </div>

  <div class="hud">
    <div class="bar">
      <button class="btn1" id="mega">ğŸ† è¶…çº§è¿å‘</button>
      <button class="btn2" id="wish">âœ¨ æ¢ä¸€å¥èµ°å¿ƒç¥ç¦</button>
    </div>
  </div>

<script>
/**
 * å…¨å±çƒŸèŠ±å¼•æ“ï¼ˆCanvas 2Dï¼‰
 * - è‡ªåŠ¨å‘å°„ + è§¦æ‘¸/ç‚¹å‡»å‘å°„
 * - ç§»åŠ¨ç«¯ç²’å­è‡ªé€‚åº”
 */

const herName = "æ˜ç "; // âœ… ç¥ç¦å¯¹è±¡åå­—ï¼ˆä½ è¦çš„ï¼‰
const titleEl = document.getElementById("title");
titleEl.textContent = `${herName}ï¼Œæ–°å¹´å¿«ä¹`;

const wishes = [
  "æ„¿ä½ è¿™ä¸€å¹´ï¼šè¢«åçˆ±ã€è¢«ç†è§£ã€è¢«æ¸©æŸ”åšå®šåœ°é€‰æ‹©ã€‚",
  "æ„¿ä½ æ°¸è¿œä¸ç¼ºé‡æ–°å¼€å§‹çš„å‹‡æ°”ï¼Œä¹Ÿä¸ç¼ºè¢«çˆ±åŒ…å›´çš„åº•æ°”ã€‚",
  "æ„¿ä½ çš„å¿ƒæ°¸è¿œæŸ”è½¯è€Œæœ‰åŠ›é‡ï¼Œç”Ÿæ´»æ°¸è¿œæ˜äº®åˆå¯çˆ±ã€‚",
  "æ„¿ä½ æŠŠè‡ªå·±ç…§é¡¾å¾—å¾ˆå¥½ï¼šå¼€å¿ƒã€å¥åº·ã€è‡ªç”±ã€é—ªé—ªå‘å…‰ã€‚",
  "æ„¿ä½ æ‰€æœ‰çš„è®¤çœŸéƒ½è¢«çœ‹è§ï¼Œæ‰€æœ‰çš„æœŸå¾…éƒ½æœ‰å›å“ã€‚",
  "æ„¿ä½ ç«™åœ¨çƒ­çˆ±é‡Œï¼Œé—ªè€€åœ¨å–œæ¬¢çš„ä¸–ç•Œé‡Œã€‚"
];

const subtitleEl = document.getElementById("subtitle");
document.getElementById("wish").addEventListener("click", () => {
  const w = wishes[Math.floor(Math.random()*wishes.length)];
  subtitleEl.innerHTML = `${w}<br/>â€”â€” é€ç»™ä½ ï¼Œ${herName}`;
  floatText(w, innerWidth*0.5, innerHeight*0.45);
  megaBurst(10);
});

const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d", { alpha: true });

let W=0,H=0,DPR=1;
function resize(){
  DPR = Math.min(2, window.devicePixelRatio || 1);
  W = Math.floor(innerWidth);
  H = Math.floor(innerHeight);
  canvas.width = Math.floor(W * DPR);
  canvas.height = Math.floor(H * DPR);
  canvas.style.width = W+"px";
  canvas.style.height = H+"px";
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
window.addEventListener("resize", resize);
resize();

// æ€§èƒ½ï¼šç§»åŠ¨ç«¯/å°å±é™ä½ç²’å­
const isMobile = matchMedia("(pointer:coarse)").matches;
let PARTICLES_PER_BURST = isMobile ? 70 : 110;
let AUTO_RATE = isMobile ? 520 : 420; // è‡ªåŠ¨å‘å°„é—´éš”

// é¢œè‰²ç›˜
const colors = [
  [255,211,122], // gold
  [255,99,198],  // pink
  [107,247,255], // cyan
  [255,255,255], // white
  [160,255,170], // green
  [200,170,255], // purple
];

function rand(a,b){ return a + Math.random()*(b-a); }
function pick(arr){ return arr[(Math.random()*arr.length)|0]; }
function clamp(x,a,b){ return Math.max(a, Math.min(b,x)); }

const rockets = [];
const sparks = [];
const texts = [];

class Rocket{
  constructor(x,y){
    this.x=x; this.y=y;
    this.vx=rand(-1.0, 1.0);
    this.vy=rand(-13.5, -18.0);
    this.ax=0; this.ay=0.18;
    this.life=0;
    this.targetY = rand(H*0.18, H*0.42);
    this.color = pick(colors);
    this.trail = [];
  }
  step(){
    this.life++;
    this.vx += this.ax;
    this.vy += this.ay;
    this.x += this.vx;
    this.y += this.vy;

    this.trail.push([this.x, this.y]);
    if(this.trail.length > 10) this.trail.shift();

    // åˆ°é«˜åº¦æˆ–éšæœºçˆ†ç‚¸
    if(this.y <= this.targetY || this.life > 90){
      explode(this.x, this.y, this.color);
      return false;
    }
    return (this.x>-50 && this.x<W+50 && this.y>-50 && this.y<H+50);
  }
  draw(){
    // å°¾è¿¹
    for(let i=0;i<this.trail.length-1;i++){
      const a = i/(this.trail.length-1);
      const p = this.trail[i];
      const q = this.trail[i+1];
      ctx.strokeStyle = `rgba(${this.color[0]},${this.color[1]},${this.color[2]},${0.35*a})`;
      ctx.lineWidth = 2.0;
      ctx.beginPath();
      ctx.moveTo(p[0],p[1]);
      ctx.lineTo(q[0],q[1]);
      ctx.stroke();
    }
    // ç«ç®­ç‚¹
    ctx.fillStyle = `rgba(${this.color[0]},${this.color[1]},${this.color[2]},0.9)`;
    ctx.beginPath();
    ctx.arc(this.x, this.y, 2.2, 0, Math.PI*2);
    ctx.fill();
  }
}

class Spark{
  constructor(x,y,color){
    this.x=x; this.y=y;
    const ang = rand(0, Math.PI*2);
    const spd = rand(2.2, 7.6);
    this.vx = Math.cos(ang)*spd;
    this.vy = Math.sin(ang)*spd;
    this.ay = 0.06;
    this.drag = 0.985;
    this.life = 0;
    this.maxLife = rand(48, 84);
    this.color = color;
    this.size = rand(1.0, 2.6);
    this.tw = rand(0.6, 1.0); // é—ªçƒ
  }
  step(){
    this.life++;
    this.vx *= this.drag;
    this.vy = this.vy*this.drag + this.ay;
    this.x += this.vx;
    this.y += this.vy;
    return this.life < this.maxLife;
  }
  draw(){
    const t = 1 - this.life/this.maxLife;
    const a = (t*t) * this.tw;
    ctx.fillStyle = `rgba(${this.color[0]},${this.color[1]},${this.color[2]},${a})`;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
    ctx.fill();
  }
}

class FloatingText{
  constructor(text,x,y){
    this.text=text;
    this.x=x; this.y=y;
    this.vy = rand(-0.6,-1.2);
    this.life=0; this.maxLife=120;
  }
  step(){
    this.life++;
    this.y += this.vy;
    return this.life < this.maxLife;
  }
  draw(){
    const t = 1 - this.life/this.maxLife;
    const a = t*t;
    ctx.save();
    ctx.globalAlpha = 0.9*a;
    ctx.font = `800 ${clamp(W/26, 16, 26)}px system-ui,-apple-system,PingFang SC,Microsoft YaHei`;
    ctx.textAlign="center";
    // å‘å…‰æè¾¹
    ctx.strokeStyle = "rgba(255,211,122,0.45)";
    ctx.lineWidth = 6;
    ctx.strokeText(this.text, this.x, this.y);
    ctx.fillStyle = "rgba(255,255,255,0.95)";
    ctx.fillText(this.text, this.x, this.y);
    ctx.restore();
  }
}

function explode(x,y,color){
  const n = PARTICLES_PER_BURST + (Math.random()*30|0);
  for(let i=0;i<n;i++){
    sparks.push(new Spark(x,y,color));
  }
  // å†å ä¸€ä¸ªéšæœºè‰²å±‚ï¼Œæ›´â€œç‚¸â€
  if(Math.random() < 0.65){
    const c2 = pick(colors);
    for(let i=0;i<(n*0.45|0);i++){
      sparks.push(new Spark(x,y,c2));
    }
  }
}

function launch(x){
  rockets.push(new Rocket(x, H + 10));
}

function autoLaunch(){
  // éšæœº 1~2 å‘
  launch(rand(W*0.15, W*0.85));
  if(Math.random() < 0.35) setTimeout(()=>launch(rand(W*0.12, W*0.88)), 90);
}

// æ›´é…·ï¼šè¶…çº§è¿å‘
function megaBurst(times=16){
  let i=0;
  const id = setInterval(()=>{
    launch(rand(W*0.12, W*0.88));
    i++;
    if(i>=times) clearInterval(id);
  }, 80);
}
document.getElementById("mega").addEventListener("click", ()=>{
  megaBurst(isMobile ? 18 : 26);
  floatText("æ˜ç ï¼Œæ–°å¹´å¿«ä¹", W*0.5, H*0.42);
});

// ç‚¹å“ªç‚¸å“ªï¼ˆè§¦æ‘¸ï¼‰
let pressTimer = null;
let pressing = false;

function handlePointer(x,y){
  // ä»åº•éƒ¨å‘å°„ï¼Œæœå‘ç›®æ ‡é«˜åº¦é™„è¿‘çˆ†ç‚¸ï¼šç”¨å¤šå‘æ¨¡æ‹Ÿâ€œæŒ‡å“ªå„¿ç‚¸â€
  const count = isMobile ? 2 : 3;
  for(let i=0;i<count;i++){
    const r = new Rocket(clamp(x + rand(-30,30), 10, W-10), H + 12);
    r.targetY = clamp(y + rand(-80, 40), H*0.14, H*0.55);
    rockets.push(r);
  }
}

window.addEventListener("pointerdown", (e)=>{
  pressing = true;
  handlePointer(e.clientX, e.clientY);
  // é•¿æŒ‰å¯†é›†
  pressTimer = setInterval(()=>{
    if(!pressing) return;
    handlePointer(e.clientX + rand(-40,40), e.clientY + rand(-20,20));
  }, 160);
}, {passive:true});

window.addEventListener("pointerup", ()=>{
  pressing = false;
  if(pressTimer) clearInterval(pressTimer);
  pressTimer = null;
}, {passive:true});

window.addEventListener("pointercancel", ()=>{
  pressing = false;
  if(pressTimer) clearInterval(pressTimer);
  pressTimer = null;
}, {passive:true});

// æ¼‚æµ®æ–‡å­—
function floatText(text, x, y){
  texts.push(new FloatingText(text, x, y));
}

// ä¸»å¾ªç¯ï¼šç”¨è½»å¾®æ‹–å½±åšâ€œç”µå½±æ„Ÿâ€
let lastAuto = 0;
function loop(ts){
  // æ‹–å½±å±‚ï¼šè¶Šå°è¶Šâ€œé•¿å°¾â€
  ctx.fillStyle = "rgba(0,0,0,0.22)";
  ctx.fillRect(0,0,W,H);

  // è‡ªåŠ¨å‘å°„
  if(ts - lastAuto > AUTO_RATE){
    autoLaunch();
    lastAuto = ts;
  }

  // æ›´æ–°/ç»˜åˆ¶ç«ç®­
  for(let i=rockets.length-1;i>=0;i--){
    const ok = rockets[i].step();
    rockets[i].draw();
    if(!ok) rockets.splice(i,1);
  }

  // æ›´æ–°/ç»˜åˆ¶ç«èŠ±
  for(let i=sparks.length-1;i>=0;i--){
    const ok = sparks[i].step();
    sparks[i].draw();
    if(!ok) sparks.splice(i,1);
  }

  // æ›´æ–°/ç»˜åˆ¶æµ®å­—
  for(let i=texts.length-1;i>=0;i--){
    const ok = texts[i].step();
    texts[i].draw();
    if(!ok) texts.splice(i,1);
  }

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

// é¦–æ¬¡æƒŠè‰³ï¼šå¼€åœºè¿å‘
setTimeout(()=>megaBurst(isMobile ? 14 : 20), 300);
setTimeout(()=>floatText("æ˜ç ï¼Œæ–°å¹´å¿«ä¹", W*0.5, H*0.42), 700);

// å°æç¤º 6 ç§’åæ·¡å‡º
const tip = document.getElementById("tip");
setTimeout(()=>{ tip.style.transition="opacity .8s ease"; tip.style.opacity="0"; }, 6000);
</script>
</body>
</html>
